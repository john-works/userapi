var hrEmpDetailsURL="",ajaxEditURL="",ajaxEditFormId="",profile_record_id=1,role_record_id=1,department_record_id=1,category_record_id=1,reg_office_record_id=1,organization_record_id=1,decimalPlaces=2,debugScript=!1;function prefillSectionDBasedOnSectionE(){$(".input-keyduty").each(function(e,t){var a=$(this).val();$(this).val(a).trigger("change")})}function setupModalsThatWillPickDataFromTheServer(){$(".hr-emp-details-button").click(function(){$(".modal-content").html('<div class="col s12 center spacer-bottom spacer-top"><h5 class="red-text center">Loading Data ...</h5></div>'),hrEmpDetailsURL=$(this).attr("data-source"),$(".modal-trigger-with-server-side-data").modal({dismissible:!0,ready:function(e,t){$.get(hrEmpDetailsURL,function(e){$(".modal-content").html(e);var t={};handleForm("#form_employee_contract","",t,!0),handleForm("#form_employee_contract_edit","edit",t,!0)})}})})}function populateFormWithAjaxData(e,t){switch(e){case"#form_modal_user_academic_bg_edit":$("#institution_edit").val(t.institution),$("#year_of_study_edit").val(t.yearOfStudy),$("#award_edit").val(t.award),$("#username_edit").val(t.username),$("#record_id_edit").val(t.id),Materialize.updateTextFields()}}function setupModalsThatWillPickDataFromTheServerDynamic(){$(".ajax-edit-button").click(function(){ajaxEditURL=$(this).attr("data-source"),handleForm(ajaxEditFormId=$(this).attr("data-modal-form-id"),"edit",{},!1),$(".modal-for-ajax-data").modal({dismissible:!0,ready:function(e,t){$.get(ajaxEditURL,function(e){var t=jQuery.parseJSON(e);0==t.statusCode?populateFormWithAjaxData(ajaxEditFormId,t.data):$(".modal-content").html(t.statusDescription)})},complete:function(){location.reload(!1)}})})}function attachListenersToDeleteButtons(){$(".timo-btn-delete").click(function(){var e=$(this).attr("data-delete-url");showDynamicDeleteConfirmDialog($(this).attr("data-item-gp"),$(this).attr("data-item-name"),e)})}function attachListenersToEditButtons(){$("#modal_hr_contract_history").on("click",".edit-button-contract",function(e){$("#form_employee_contract").addClass("hidden"),$("#form_employee_contract_edit").removeClass("hidden");var t=$(this).attr("data-ref"),a=$(this).attr("data-start-date"),i=$(this).attr("data-expiry-date"),d=$(this).attr("data-record-id");$("#contract_reference_edit").val(t),$("#contract_start_date_edit").val(a),$("#contract_expiry_date_edit").val(i),$("#record_id_edit").val(d),Materialize.updateTextFields()}),$("#modal_hr_contract_history").on("click",".cancel-edit-button",function(e){$("#form_employee_contract_edit").addClass("hidden"),$("#form_employee_contract").removeClass("hidden")}),$(".edit-btn-competence-cat").click(function(){var e=$(this).attr("data-record-id"),t=$(this).attr("data-org-code"),a=$(this).attr("data-emp-cat-code"),i=$(this).attr("data-cat"),d=$(this).attr("data-max-rating");$("#org_code_edit").find('option[value="'+t+'"]').prop("selected",!0),$("#employee_category_code_edit").find('option[value="'+a+'"]').prop("selected",!0),$("#competence_category_edit").val(i),$("#max_rating_edit").val(d),$("#record_id_edit").val(e),handleForm("#form_modal_competence_cat_edit","edit",{},!0),Materialize.updateTextFields()}),$(".edit-btn-objective").click(function(){var e=$(this).attr("data-form-id"),t=$(this).attr("data-record-id"),a=$(this).attr("data-org-code"),i=$(this).attr("data-obj");$("#organization_edit").find('option[value="'+a+'"]').prop("selected",!0),$('input:hidden[name="record_id"]').val(t),$("#objective_edit").val(i),handleForm("#"+e,"edit",{},!0),Materialize.updateTextFields()}),$(".edit-btn-competence").click(function(){var e=$(this).attr("data-form-id"),t=$(this).attr("data-record-id"),a=$(this).attr("data-competence"),i=$(this).attr("data-rank"),d=$(this).attr("data-rating"),r=$(this).attr("data-cat-id");$('input:hidden[name="record_id"]').val(t),$("#competence_edit").val(a),$("#rank_edit").val(i),$("#rating_edit").val(d),$("#competence_category_id_edit").val(r),handleForm("#"+e,"edit",{},!0),Materialize.updateTextFields()}),$(".edit-btn-appraisal-approvers").click(function(){var e=$(this).attr("data-appraisal-ref"),t=$(this).attr("data-hod"),a=$(this).attr("data-supervisor"),i=$(this).attr("data-ed");$("#head_of_department").find('option[value="'+t+'"]').prop("selected",!0),$("#supervisor").find('option[value="'+a+'"]').prop("selected",!0),$("#executive_director").find('option[value="'+i+'"]').prop("selected",!0),$('input:hidden[name="appraisal_ref"]').val(e),handleForm("#form_modal_appraisal_approvers","",{},!0),Materialize.updateTextFields()}),$(".edit-button").click(function(){handleForm("#edit_profile_form",profile_record_id=$(this).attr("data-user_id"),{org_code:"#org_code_"+profile_record_id,regional_office_code:"#regional_office_code_"+profile_record_id,department_code:"#department_code_"+profile_record_id,category_code:"#category_code_"+profile_record_id,role_code:"#role_code_"+profile_record_id},!0)}),$("#btn_save_academic_bg").click(function(){handleForm("#form_modal_user_academic_bg","",{},!0)}),$("#btn_save_competence_cat").click(function(){handleForm("#form_modal_competence_cat","",{},!0)}),$("#btn_save_competence").click(function(){handleForm("#form_modal_competence","",{},!0)}),$("#btn_save_objective").click(function(){handleForm("#"+$(this).attr("data-form-id"),"",{},!0)}),$(".timo-btn-add").click(function(){handleForm("#"+$(this).attr("data-form-id"),"",{},!0)}),$(".edit-button-department").click(function(){handleForm("#edit_department_form",department_record_id=$(this).attr("data-record-id"),{org_code:"#org_code_"+department_record_id},!0)}),$(".edit-button-categories").click(function(){handleForm("#edit_category_form",category_record_id=$(this).attr("data-record-id"),{org_code:"#org_code_"+category_record_id},!0)}),$(".edit-button-regional-office").click(function(){handleForm("#edit_regional_office_form",reg_office_record_id=$(this).attr("data-record-id"),{org_code:"#org_code_"+reg_office_record_id},!0)}),$(".edit-button-organization").click(function(){handleForm("#edit_organization_form",organization_record_id=$(this).attr("data-record-id"),{},!0)}),$(".edit-button-role-code").click(function(){handleForm("#edit_role_code_form",role_record_id=$(this).attr("data-record-id"),{org_code:"#org_code_"+role_record_id},!0)})}function setDatePickerValue(e){alert("sasasa")}function printErrorMsg(e,t){var a="#print-error-msg"+t;$(a).find("ul").html(""),$(a).css("display","block"),$.each(e,function(e,t){$(a).find("ul").append("<li>"+t+"</li>")})}function printErrorMsgDocumentTypes(e){var a="#print-error-msg-doc-type"+document_type_record_id;$(a).find("ul").html(""),$(a).css("display","block"),$.each(e,function(e,t){$(a).find("ul").append("<li>"+t+"</li>")})}function clearErrorMsg(e){var t="#print-error-msg"+e;$(t).find("ul").html(""),$(t).css("display","none")}function printSuccessMessage(e,t){var a=null==t?"":t.success;$(e).text(a)}function handleForm(e,d,r,o){var c=$(e+("edit"==d?"":d)),l=$("#form-messages"+d);$(c).submit(function(e){e.preventDefault();var t=$(c).serializeArray();for(var a in r)if(r.hasOwnProperty(a)){var i=$(r[a]).val();t.push({name:a,value:i})}return $.ajaxSetup({headers:{"X-Requested-With":"XMLHttpRequest"}}),$.ajax({type:"POST",url:$(c).attr("action"),data:t,success:function(e){$.isEmptyObject(e.error)?o?window.location.reload(!0):(printSuccessMessage(l,e),clearErrorMsg(d)):(printSuccessMessage(l,null),printErrorMsg(e.error,d))},error:function(e){alert(e)}}),!1})}function handleUserProfileForm(){var a=document.getElementById("edit_profile_form"+profile_record_id),i=document.getElementById("form-messages"+profile_record_id);alert(i),$(a).submit(function(e){var t=$(a).serializeArray();$orgCode=$("#org_code_"+profile_record_id).val(),$regionalOfficeCode=$("#regional_office_code_"+profile_record_id).val(),$deptCode=$("#department_code_"+profile_record_id).val(),$categoryCode=$("#category_code_"+profile_record_id).val(),$roleCode=$("#role_code_"+profile_record_id).val(),t.push({name:"org_code",value:$orgCode}),t.push({name:"regional_office_code",value:$regionalOfficeCode}),t.push({name:"department_code",value:$deptCode}),t.push({name:"category_code",value:$categoryCode}),t.push({name:"role_code",value:$roleCode}),$.ajaxSetup({headers:{"X-Requested-With":"XMLHttpRequest",Accepts:"application/json"}}),$.ajax({type:"POST",url:$(a).attr("action"),data:t,success:function(e){$.isEmptyObject(e.error)?(printSuccessMessage(i,e),clearErrorMsg(profile_record_id)):(printSuccessMessage(i,null),printErrorMsg(e.error,profile_record_id))},error:function(e){alert(e)}}),e.preventDefault()})}function showDeleteConfirmationModal(e,t){$("#"+t).modal("open"),$("#"+t+"_YesBtn").click(function(){$("#"+t).modal("close"),document.location=e.href})}function showDynamicDeleteConfirmDialog(e,t,a){$("#item_group").text(e),$("#item_name").text(t),$("#modal_delete").modal("open"),$("#modal_delete_YesBtn").click(function(){$("#modal_delete").modal("close"),document.location=a})}function closeModalAndRedirect(e,t){return $(e).modal("close"),document.location=t,!1}function toFixed(e,t){var a=Math.pow(10,t||0);return String(Math.round(e*a)/a)}function sumRow(e,t,a,i){for(var d=0,r=1;r<=t;r++){var o=parseFloat($("#"+e+r).val());isNaN(o)||(d+=o)}i<d?(alert("Total is beyond "+i+", please check input"),$("#"+a).val("")):$("#"+a).val(d),calculateSectionDAndSectionDAdditionalAsAPercentage()}function calculateSectionDAndSectionDAdditionalAsAPercentage(){var e=parseFloat($("#sec_d_total_agreed_rating").val()),t=parseFloat($("#sec_d_add_total_agreed_rating").val());if(isNaN(e)||isNaN(t))$("#sec_d_final_percentage_score").val("");else{var a=100*(e+t)/120;$("#sec_d_final_percentage_score").val(toFixed(a,decimalPlaces))}apply80PercentWeightOnSectionD()}function apply80PercentWeightOnSectionD(){var e=0,t=window.document.getElementById("sec_d_final_percentage_score"),a=window.document.getElementById("sec_d_weighed");isNaN(t.value)?a.value="":(e=parseFloat(t.value)/100*80,a.value=isNaN(e)?"":toFixed(e,decimalPlaces)),window.document.getElementById("FinalScoreSecD").value=a.value,sumSections()}function finishTable(e,t,a){var i=t,d=e,r=a,o=0,c=window.document.getElementById(r);try{o=computeTableColumnTotal(d,i),c.value=o.toLocaleString(),"table_sec_e"==e&&calculateSecEpercent()}catch(e){window.alert("Exception in function finishTable()\n"+e)}finally{return void(event.target.style.background="")}}function computeTableColumnTotal(e,t){var a=0;debugScript&&window.alert("Processing table "+e+" Column "+t);try{for(var i=window.document.getElementById(e).getElementsByTagName("tbody").item(0),d=i.rows.length,r=1;r<d;r++){var o=i.rows[r].cells[t];if(null!=o.children[0]){var c=o.children[0],l=parseFloat(c.value.replace(/,/g,""));debugScript&&window.alert("Row "+r+" Column "+t+" value is "+l),isNaN(l)||(a+=l)}}}catch(e){window.alert("Exception in function computeTableColumnTotal()\n"+e),a=0}finally{return debugScript&&window.alert("Total is: "+a),a}}function calculateSecEpercent(){var e=window.document.getElementById("secEmaxTotal"),t=window.document.getElementById("secEagreedTotal"),a=parseFloat(e.value),i=parseFloat(t.value),d=window.document.getElementById("sec_e_final_percentage_score");if(!isNaN(a)&&!isNaN(a)){var r=i/a*100;d.value=toFixed(r,3),calculateSecEpercentActual()}}function calculateSecEpercentActual(){var e=0,t=window.document.getElementById("sec_e_final_percentage_score"),a=window.document.getElementById("sec_e_weighed");isNaN(t.value)||(e=parseFloat(t.value)/100*20,a.value=toFixed(e,3),window.document.getElementById("FinalScoreSecE").value=toFixed(e,3)),sumSections()}function sumSections(){var e=window.document.getElementById("FinalScoreSecD"),t=window.document.getElementById("FinalScoreSecE"),a=window.document.getElementById("OverallTotal");if(!isNaN(e.value)&&!isNaN(t.value)){var i=parseFloat(e.value)+parseFloat(t.value);a.value=toFixed(i,3);window.document.getElementById("sumScored04"),window.document.getElementById("sumScored05"),window.document.getElementById("sumScoredTotal")}}function generateChildRowHtml(e,t){if("parent_dynamic_education_bg"==t)return'<div class="col m1 s12 ">'+e+'</div> <div class="col m4 s12 "><input id="school_'+e+'" name="school_'+e+'" type="text" class="validate"></div><div class="col m2 s12 "><input id="year_of_study_'+e+'" name="year_of_study_'+e+'" type="text" class="validate"></div><div class="col m5 s12 "><input id="award_'+e+'" name="award_'+e+'" type="text" class="validate"></div>';if("parent_dynamic_key_duties"==t){var a="assignment_"+e,i="expected_output_"+e,d="expected_output_sec_d_"+e,r="max_rating_"+e,o="time_frame_"+e,c="form_field_count"+e;return'<div class="row"><div class="col m1 s12 ">'+e+'</div><div class="col m11 s12"><select name="objective_'+e+'" required class="browser-default validate s12" style="width: 100%">'+document.getElementsByName("objective_1").item(0).innerHTML+'</select></div></div><div class="row "><div class="col m1 s12 "></div><div class="col m4 s12 "><textarea  id="'+a+'" onchange="copyBetweenTextField(0,1)" name="'+a+'" type="text" class="validate"></textarea></div><div class="col m4 s12 "><textarea id="'+i+'" name="'+i+'" type="text" class="validate"></textarea></div><div class="col m1 s12 "><input  id="'+r+'" name="'+r+'" type="number"  class="validate browser-default tab-input "></div><div class="col m2 s12 "><input  id="'+o+'" name="'+o+'" type="text" class="validate  browser-default tab-input"></div><input type="hidden" name="'+c+'" value="'+e+'"/></div>'}if("parent_dynamic_assignments"==t){d="expected_output_sec_d_"+e;var l="actual_performance_"+e,n="max_rating_sec_d"+e,s="appraisee_rating_sec_d"+e,_="appraiser_rating_sec_d"+e,m="agreed_rating_sec_d"+e;return'<div class="row"><div class="col m1 s12 ">'+e+'</div><div class="col m11 s12" style="padding-left: 1.5%"><select  name="'+("objective_"+e)+'" required class="browser-default validate s12" style="width: 100%">'+document.getElementsByName("objective_1").item(0).innerHTML+'</select></div></div><div class="row"><div class="col s7"><div class="col s2 "></div><div class="col s5 "><textarea id="'+d+'" name="'+d+'" type="text" class="validate"></textarea></div><div class="col s5 "><textarea id="'+l+'" name="'+l+'" type="text" class="validate"></textarea></div></div><div class="col s5"><div class="col s3 "><input id="'+n+'" min="0" name="'+n+'" type="number" onblur="sumRow(\'max_rating_sec_d\',14,\'sec_d_total_max_rating\',100)" class="validate browser-default tab-input"></div><div class="col s3 "><input id="'+s+'" min="0" name="'+s+'" onblur="sumRow(\'appraisee_rating_sec_d\',14,\'sec_d_total_appraisee_rating\',100)" type="number" class="validate browser-default tab-input"></div><div class="col s3 "><input id="'+_+'" min="0" name="'+_+'" onblur="sumRow(\'appraiser_rating_sec_d\',14,\'sec_d_total_appraiser_rating\',100)" type="number" class="validate browser-default tab-input"></div><div class="col s3 "><input id="'+m+'" min="0" name="'+m+'" onblur="sumRow(\'agreed_rating_sec_d\',14,\'sec_d_total_agreed_rating\',100)" type="number" class="validate browser-default tab-input"></div></div></div>'}if("parent_dynamic_additional_assignments"==t){d="expected_output_sec_d_add"+e,l="actual_performance_sec_d_add"+e,n="max_rating_sec_d_add"+e,s="appraisee_rating_sec_d_add"+e,_="appraiser_rating_sec_d_add"+e,m="agreed_rating_sec_d_add"+e;return'<div class="row"><div class="col m1 s12 ">'+e+'</div><div class="col m11 s12" style="padding-left: 1.5%"><select  name="'+("objective_"+e)+'" required class="browser-default validate s12" style="width: 100%">'+document.getElementsByName("objective_1").item(0).innerHTML+'</select></div></div><div class="row"><div class="col s7"><div class="col s2 "></div><div class="col s5 "><textarea id="'+d+'" name="'+d+'" type="text" class="validate"></textarea></div><div class="col s5 "><textarea id="'+l+'" name="'+l+'" type="text" class="validate"></textarea></div></div><div class="col s5"><div class="col s3 "><input id="'+n+'" min="0" name="'+n+'" type="number" onblur="sumRow(\'max_rating_sec_d_add\',5,\'sec_d_add_total_max_rating\',20)" class="validate browser-default tab-input"></div><div class="col s3 "><input id="'+s+'" min="0" name="'+s+'" onblur="sumRow(\'appraisee_rating_sec_d_add\',5,\'sec_d_add_total_appraisee_rating\',20)" type="number" class="validate browser-default tab-input"></div><div class="col s3 "><input id="'+_+'" min="0" name="'+_+'" onblur="sumRow(\'appraiser_rating_sec_d_add\',5,\'sec_d_add_total_appraiser_rating\',20)" type="number" class="validate browser-default tab-input"></div><div class="col s3 "><input id="'+m+'" min="0" name="'+m+'" onblur="sumRow(\'agreed_rating_sec_d_add\',5,\'sec_d_add_total_agreed_rating\',20)" type="number" class="validate browser-default tab-input"></div></div></div>'}if("parent_dynamic_challenges"==t){var u="challenge_"+e,p="challenge_cause_"+e,v="challenge_recommendation_"+e,f="challenge_when_"+e;return'<div class="col s12"><div class="col s1 ">'+e+'</div><div class="col s3 "><textarea id="'+u+'" name="'+u+'" type="text" class="validate"></textarea></div><div class="col s3 "><textarea id="'+p+'" name="'+p+'" type="text" class="validate"></textarea></div><div class="col s3 "><textarea id="'+v+'" name="'+v+'" type="text" class="validate"></textarea></div><div class="col s2 "><input id="'+f+'" name="'+f+'" type="text" class="validate browser-default tab-input"></div></div>'}if("parent_dynamic_performance_gaps"==t){var g="gap_"+e,$="cause_"+e,h="recommendation_"+e,y="when_"+e;return'<div class="col s12"><div class="col s1 ">'+e+'</div><div class="col s3 "><textarea id="'+g+'" name="'+g+'" type="text" class="validate"></textarea></div><div class="col s3 "><textarea id="'+$+'" name="'+$+'" type="text" class="validate"></textarea></div><div class="col s3 "><textarea id="'+h+'" name="'+h+'" type="text" class="validate"></textarea></div><div class="col s2 "><input id="'+y+'" name="'+y+'" type="text" class="validate browser-default tab-input"></div></div>'}if("parent_dynamic_workplan"!=t)return"Invalid Row Parent ID Supplied";var b="assignment_"+e,w="expected_output_"+e,x="max_rating"+e,E="time_frame_"+e;return'<div class="row "><div class="col m1 s12 ">'+e+'</div><div class="col m4 s12 "><textarea id="'+b+'" name="'+b+'" type="text" class="validate"></textarea></div><div class="col m4 s12 "><textarea id="'+w+'" name="'+w+'" type="text" class="validate"></textarea></div><div class="col m1 s12 "><input id="'+x+'" name="'+x+'" type="number" class="validate browser-default tab-input"></div><div class="col m2 s12 "><input id="'+E+'" name="'+E+'" type="text" class="validate browser-default tab-input"></div><input type="hidden" name="'+("record_id_count"+e)+'" value="'+e+'"></div>'}function addElement(e,t,a){var i=document.getElementById(e),d=document.getElementById(a),r=null==d||null==d.value?0:d.value,o=parseInt(r)+1,c=document.createElement(t);c.setAttribute("class","row");var l=generateChildRowHtml(o,e);c.innerHTML=l,i.appendChild(c),d.value=i.childElementCount}function deleteLastElement(e,t){var a=document.getElementById(e);if(a.childElementCount<=1)alert("You cannot remove all fields");else{var i=a.lastElementChild;a.removeChild(i),document.getElementById(t).value=a.childElementCount}}$(document).ready(function(){var e=moment().format("YYYY-MM-DD");$(".modal").modal({dismissible:!0}),$("tabs").tabs(),$(".dropdown-trigger").dropdown(),$(".dropdown-button").dropdown(),setupModalsThatWillPickDataFromTheServer(),setupModalsThatWillPickDataFromTheServerDynamic(),attachListenersToEditButtons(),attachListenersToDeleteButtons(),$("#modal_deletion").modal("open"),$("#modal_message").modal("open"),$("select").material_select(),$(".button-collapse").sideNav(),$(".parallax").parallax();var t=document.querySelector(".stepper");new MStepper(t,{firstActive:0});$(".datepicker").pickadate({selectMonths:!0,selectYears:100,format:"yyyy-mm-dd",defaultDate:e,setDefaultDate:!0}),$("#modal_org_created").modal("open"),$("#modal_account_created").modal("open"),$("#modal_change_password").modal("open"),$("#modal_successful_operation").modal("open"),$("#modal_form_message").modal("open"),$("#user_profiles_table").pageMe({pagerSelector:"#myPager",activeColor:"green",prevText:"Previous",nextText:"Next",showPrevNext:!0,hidePageNumbers:!1,perPage:7,totalLabel:"#total_users"}),$("#document_types_table").pageMe({pagerSelector:"#myPagerDocumentTypes",activeColor:"green",prevText:"Previous",nextText:"Next",showPrevNext:!0,hidePageNumbers:!1,perPage:7,totalLabel:"#total_reg"}),prefillSectionDBasedOnSectionE()});